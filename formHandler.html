	<script runat="server">

    Platform.Load("core", "1.1.1");

    var referer = String(Platform.Request.ReferrerURL).split("?")[0];

    try {
      
     </script>

	 %%[

        SET @SubscriberKey = RequestParameter("SubscriberKey")
			IF Empty(@SubscriberKey)
				THEN SET @SubscriberKey = @EmailAddress
			ELSE 
		ENDIF
		
		SET @EmailAddress = RequestParameter("EmailAddress")
		SET @FirstName = RequestParameter("FirstName")
		SET @LastName = RequestParameter("LastName")
		SET @ZipCode = RequestParameter("ZipCode")
        SET @IsEngaged = RequestParameter("IsEngaged")

		SET @result = InsertData(
			"Foundation-Form", 
			"SubscriberKey", @SubscriberKey, 			
			"EmailAddress", @EmailAddress,
			"FirstName", @FirstName, 
			"LastName", @LastName, 
			"ZipCode", @ZipCode, 
			"IsEngaged", @IsEngaged
		)
          
      ]%%

	%%=v(@result)=%%
	
	<script runat="server">
        
    } catch (err) {

      referer += "?error=1&message=" + Stringify(err.message) + Stringify(err.description);
      Platform.Response.Redirect(referer);

    } finally {

      Platform.Response.Redirect(referer + "?ok=1");
      
    }
	</script>